<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>KrushiMitra</title>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: #f4f7f9;
            margin: 0;
            padding: 0;
        }

        header {
            background: linear-gradient(135deg, #0a7e8c, #2bb673);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            margin: 0;
            font-weight: 600;
        }

        header p {
            margin-top: 8px;
            opacity: 0.9;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }

        .card {
            background: white;
            border-radius: 14px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        h3 {
            color: #0a7e8c;
            margin-bottom: 15px;
        }

        input[type="file"],
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #ccc;
            margin-top: 10px;
        }

        button {
            width: 100%;
            margin-top: 15px;
            padding: 12px;
            background: #0a7e8c;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }

        button:hover {
            background: #06626c;
        }

        .result-box {
            background: #f0f9f6;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        img {
            width: 100%;
            border-radius: 10px;
            margin-top: 10px;
        }

        /* Water Section */
        .water-section {
            background: #e0f7fa;
            padding: 30px;
            border-radius: 16px;
            margin-top: 40px;
        }

        .water-section ul {
            list-style: none;
            padding: 0;
        }

        .water-section li {
            margin-bottom: 10px;
        }

        #water-map {
            height: 400px;
            border-radius: 12px;
            margin-top: 20px;
        }

        /* Vendors */
        .vendors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .vendor-card {
            background: white;
            border-radius: 14px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        }

        .vendor-card h4 {
            margin: 0;
            color: #2bb673;
        }

        .vendor-card p {
            margin: 6px 0;
            font-size: 14px;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #777;
            margin-top: 40px;
        }
    </style>
</head>

<body>

<header>
    <h1>üåæ KrushiMitra</h1>
    <p>Weed Detection ‚Ä¢ Crop Recommendation ‚Ä¢ Water & Vendor Advisory</p>
</header>

<div class="container">

    <div class="grid">
        <!-- Weed Detection -->
        <div class="card">
            <h3>üåø Weed Detection</h3>
            <form action="/" method="POST" enctype="multipart/form-data">
                <input type="file" name="image">
                <button type="submit">Detect Weeds</button>
            </form>

            {% if result %}
            <div class="result-box">
                <h4>Detection Result</h4>
                <img src="{{ result }}">
            </div>
            {% endif %}
        </div>

        <!-- Weather & Crop -->
        <div class="card">
            <h3>üå¶ Weather & Crop Recommendation</h3>
            <form action="/" method="POST">
                <input type="text" name="city" placeholder="Enter Maharashtra city">
                <button type="submit">Get Recommendation</button>
            </form>

            {% if weather and not weather.error %}
            <div class="result-box">
                <p><b>City:</b> {{ weather.city }}</p>
                <p>üå° {{ weather.temp }} ¬∞C</p>
                <p>üíß {{ weather.humidity }}%</p>
                <p>üåß {{ weather.rainfall }} mm</p>

                <h4>üåæ Suitable Crops</h4>
                <ul>
                    {% for crop in crops %}
                        <li>{{ crop }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Water Management -->
    {% if water %}
    <div class="water-section">
        <h3 style="text-align:center;">üíß Water Management Advisory</h3>
        <ul>
            <li><b>Status:</b> {{ water.status }}</li>
            <li><b>Irrigation:</b> {{ water.irrigation }}</li>
            <li><b>Source:</b> {{ water.source }}</li>
            <li><b>Precautions:</b> {{ water.warning }}</li>
        </ul>

        {% if water.details %}
        <div id="water-map"></div>
        <script>
            var map = L.map('water-map').setView(
                [{{ water.details[0].lat }}, {{ water.details[0].lon }}], 12
            );

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

            {% for wb in water.details %}
            L.marker([{{ wb.lat }}, {{ wb.lon }}])
                .addTo(map)
                .bindPopup("<b>{{ wb.name }}</b><br>{{ wb.distance }} km");
            {% endfor %}
        </script>
        {% endif %}
    </div>
    {% endif %}

    <!-- Vendors -->
    {% if vendors %}
    <div class="card" style="margin-top:40px;">
        <h3>üè™ Nearby Agriculture Vendors</h3>

        <div class="vendors-grid">
            {% for v in vendors %}
            <div class="vendor-card">
                <h4>{{ v.Vendor_Name }}</h4>
                <p>üìç {{ v.Shop_Address }}, {{ v.City }}</p>
                <p>üß∫ {{ v.Products_Sold }}</p>
                <p>üí∞ {{ v.Price_Range }}</p>
                <p>üìû {{ v.Contact_Number }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

</div>

<footer>
    ¬© 2025 Maharashtra Smart Agriculture | Academic Project
</footer>

</body>
</html>
